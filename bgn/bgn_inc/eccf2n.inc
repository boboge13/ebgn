/******************************************************************************
*
* Copyright (C) Chaoyong Zhou
* Email: bgnvendor@gmail.com 
* QQ: 312230917
*
*******************************************************************************/
#ifndef _ECCF2N_INC
#define _ECCF2N_INC

#include "findex.inc"

static void ecc_f2n_compute_z(const UINT32 eccf2n_md_id, const BIGINT *x, BIGINT *z);
static void ecc_f2n_compute_gz(const UINT32 eccf2n_md_id, const BIGINT *z, const UINT32 maxindex, BIGINT *gz);
static void ecc_f2n_compute_trace(const UINT32 eccf2n_md_id, const BIGINT *z, const BIGINT *gz, BIGINT *trace);
static EC_BOOL ecc_f2n_x_is_on_curve(const UINT32 eccf2n_md_id, const BIGINT * x, BIGINT * gz);


FUNC_ADDR_NODE g_eccf2n_func_addr_list[ ] = {
{
/*func priority   */    PRIO_BEG,
/*func logic addr */    (UINT32)ecc_f2n_print_module_status,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_print_module_status",
/*func index      */    FI_ecc_f2n_print_module_status,
/*func ret type   */    e_dbg_void,
/*func para num   */    2,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IO,},
/*func para type  */    {e_dbg_UINT32,e_dbg_LOG_ptr,},
/*func para val   */    0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_free_module_static_mem,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_free_module_static_mem",
/*func index      */    FI_ecc_f2n_free_module_static_mem,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    1,
/*func para direct*/    {E_DIRECT_IN,},
/*func para type  */    {e_dbg_UINT32,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_start,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_start",
/*func index      */    FI_ecc_f2n_start,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    7,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,},
/*func para type  */    {e_dbg_BIGINT_ptr,e_dbg_ECF2N_CURVE_ptr,e_dbg_BIGINT_ptr,e_dbg_BIGINT_ptr,e_dbg_EC_CURVE_POINT_ptr,e_dbg_FUNC_RAND_GEN,e_dbg_FUNC_HASH
,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_end,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_end",
/*func index      */    FI_ecc_f2n_end,
/*func ret type   */    e_dbg_void,
/*func para num   */    1,
/*func para direct*/    {E_DIRECT_IN,},
/*func para type  */    {e_dbg_UINT32,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_get_public_key,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_get_public_key",
/*func index      */    FI_ecc_f2n_get_public_key,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    3,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_BIGINT_ptr,e_dbg_EC_CURVE_POINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_random_generator_default,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_random_generator_default",
/*func index      */    FI_ecc_f2n_random_generator_default,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    1,
/*func para direct*/    {E_DIRECT_OUT,},
/*func para type  */    {e_dbg_BIGINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_rnd_private_key,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_rnd_private_key",
/*func index      */    FI_ecc_f2n_rnd_private_key,
/*func ret type   */    e_dbg_void,
/*func para num   */    2,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_BIGINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_generate_keypair,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_generate_keypair",
/*func index      */    FI_ecc_f2n_generate_keypair,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    2,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_ECC_KEYPAIR_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_encoding,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_encoding",
/*func index      */    FI_ecc_f2n_encoding,
/*func ret type   */    e_dbg_int,
/*func para num   */    4,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_UINT8_ptr,e_dbg_UINT32,e_dbg_EC_CURVE_POINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_decoding,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_decoding",
/*func index      */    FI_ecc_f2n_decoding,
/*func ret type   */    e_dbg_void,
/*func para num   */    5,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_EC_CURVE_POINT_ptr,e_dbg_UINT32,e_dbg_UINT8_ptr,e_dbg_UINT32_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_encryption,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_encryption",
/*func index      */    FI_ecc_f2n_encryption,
/*func ret type   */    e_dbg_void,
/*func para num   */    5,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_EC_CURVE_POINT_ptr,e_dbg_EC_CURVE_POINT_ptr,e_dbg_EC_CURVE_POINT_ptr,e_dbg_EC_CURVE_POINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_decryption,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_decryption",
/*func index      */    FI_ecc_f2n_decryption,
/*func ret type   */    e_dbg_void,
/*func para num   */    5,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_BIGINT_ptr,e_dbg_EC_CURVE_POINT_ptr,e_dbg_EC_CURVE_POINT_ptr,e_dbg_EC_CURVE_POINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_do_hash_default,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_do_hash_default",
/*func index      */    FI_ecc_f2n_do_hash_default,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    3,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT8_ptr,e_dbg_UINT32,e_dbg_BIGINT_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_signate,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_signate",
/*func index      */    FI_ecc_f2n_signate,
/*func ret type   */    e_dbg_UINT32,
/*func para num   */    5,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_OUT,},
/*func para type  */    {e_dbg_UINT32,e_dbg_BIGINT_ptr,e_dbg_UINT8_ptr,e_dbg_UINT32,e_dbg_ECC_SIGNATURE_ptr,},
/*func para val   */     0, 0, {0},
},
{
/*func priority   */    PRIO_MD_ECCF2N,
/*func logic addr */    (UINT32)ecc_f2n_verify,
/*func beg addr   */    0,
/*func end addr   */    0,
/*func addr offset*/    0,
/*func name       */    "ecc_f2n_verify",
/*func index      */    FI_ecc_f2n_verify,
/*func ret type   */    e_dbg_EC_BOOL,
/*func para num   */    5,
/*func para direct*/    {E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,E_DIRECT_IN,},
/*func para type  */    {e_dbg_UINT32,e_dbg_EC_CURVE_POINT_ptr,e_dbg_UINT8_ptr,e_dbg_UINT32,e_dbg_ECC_SIGNATURE_ptr,},
/*func para val   */     0, 0, {0},
},

};

UINT32 g_eccf2n_func_addr_list_len = sizeof(g_eccf2n_func_addr_list)/sizeof(g_eccf2n_func_addr_list[0]);

#endif/*_ECCF2N_INC*/
